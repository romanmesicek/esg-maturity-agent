<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nachhaltigkeitsanalyse: {{FIRMENNAME}}</title>
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            /* Certisix Sustainability Brand Colors */
            --brand-jade: #004A4A;
            --brand-olive: #959E40;
            --brand-purple: #AA80E0;
            --brand-coral: #FC6E45;
            --brand-white: #FFFFFC;
            /* Stage Colors for Maturity Levels */
            --stage-1: #e74c3c;
            --stage-2: #e67e22;
            --stage-3: #f1c40f;
            --stage-4: #27ae60;
            --stage-5: #2ecc71;
            /* UI Colors mapped to brand */
            --primary: var(--brand-jade);
            --secondary: #006666;
            --light: #f5f7f5;
            --border: #d0d8d0;
            --accent: var(--brand-coral);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Raleway', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-weight: 400;
            line-height: 1.6;
            color: var(--primary);
            background: var(--brand-white);
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        @media print {
            body {
                padding: 20px;
                max-width: none;
            }
            .no-print {
                display: none;
            }
            .page-break {
                page-break-before: always;
            }
        }

        header {
            background: var(--brand-jade);
            color: var(--brand-white);
            padding: 40px;
            border-radius: 12px;
            margin-bottom: 40px;
        }

        h1 {
            font-size: 2.5em;
            font-weight: 600;
            color: var(--brand-white);
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.2em;
            color: var(--brand-white);
            opacity: 0.95;
        }

        .meta {
            display: flex;
            gap: 30px;
            margin-top: 15px;
            font-size: 0.9em;
            color: var(--brand-white);
            opacity: 0.85;
        }

        h2 {
            font-size: 1.5em;
            font-weight: 500;
            color: var(--primary);
            border-bottom: 3px solid var(--brand-coral);
            padding-bottom: 10px;
            margin: 40px 0 20px 0;
        }

        h3 {
            font-size: 1.2em;
            font-weight: 500;
            color: var(--secondary);
            margin: 25px 0 15px 0;
        }

        h4 {
            font-size: 1.1em;
            font-weight: 500;
            color: var(--primary);
            margin: 20px 0 10px 0;
        }

        .executive-summary {
            background: var(--light);
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        /* Großes Radar-Diagramm am Anfang */
        .radar-hero {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 12px rgba(0,74,74,0.08);
            margin-bottom: 40px;
            text-align: center;
        }

        .radar-hero h2 {
            border: none;
            margin-top: 0;
        }

        .radar-hero-container {
            max-width: 700px;
            margin: 0 auto;
        }

        .detail-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .detail-table th,
        .detail-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--border);
            vertical-align: top;
        }

        .detail-table th {
            background: var(--brand-jade);
            color: var(--brand-white);
            font-weight: 500;
        }

        .detail-table tr:hover {
            background: var(--light);
        }

        .detail-table td.reasoning {
            font-size: 0.9em;
            line-height: 1.5;
        }

        .score-badge {
            display: inline-block;
            width: 40px;
            height: 40px;
            line-height: 40px;
            text-align: center;
            border-radius: 50%;
            font-weight: bold;
            color: white;
        }

        .score-1 { background: var(--stage-1); }
        .score-2 { background: var(--stage-2); }
        .score-3 { background: var(--stage-3); color: var(--primary); }
        .score-4 { background: var(--stage-4); }
        .score-5 { background: var(--stage-5); }

        .confidence {
            font-size: 0.8em;
            padding: 3px 8px;
            border-radius: 4px;
            font-weight: 500;
        }

        .confidence-high { background: #d4edda; color: #155724; }
        .confidence-medium { background: #fff3cd; color: #856404; }
        .confidence-low { background: #f8d7da; color: #721c24; }

        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 20px 0;
        }

        .analysis-card {
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 20px;
        }

        .analysis-card h4 {
            color: var(--primary);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light);
        }

        .strengths-title {
            color: var(--brand-olive);
            font-weight: 600;
            margin: 15px 0 10px 0;
        }

        .weaknesses-title {
            color: var(--brand-coral);
            font-weight: 600;
            margin: 15px 0 10px 0;
        }

        ul {
            list-style: none;
            padding: 0;
        }

        ul li {
            padding: 8px 0;
            padding-left: 20px;
            position: relative;
        }

        ul li::before {
            content: "•";
            position: absolute;
            left: 0;
            color: var(--primary);
        }

        .strengths li::before { color: var(--brand-olive); }
        .weaknesses li::before { color: var(--brand-coral); }

        /* Erweiterter Branchenvergleich */
        .benchmark-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .benchmark-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
        }

        .benchmark-table th,
        .benchmark-table td {
            padding: 12px 15px;
            text-align: left;
            border: 1px solid var(--border);
        }

        .benchmark-table th {
            background: var(--secondary);
            color: var(--brand-white);
            font-weight: 500;
        }

        .benchmark-subsection {
            margin: 25px 0;
        }

        .benchmark-subsection h4 {
            color: var(--secondary);
            border-left: 4px solid var(--brand-coral);
            padding-left: 15px;
        }

        .sources {
            background: var(--light);
            padding: 20px;
            border-radius: 8px;
            margin-top: 40px;
        }

        .sources ol {
            padding-left: 20px;
            columns: 2;
            column-gap: 40px;
        }

        .sources li {
            padding: 5px 0;
            font-size: 0.9em;
            break-inside: avoid;
        }

        .sources a {
            color: var(--brand-jade);
            text-decoration: none;
        }

        .sources a:hover {
            color: var(--brand-coral);
            text-decoration: underline;
        }

        footer {
            margin-top: 60px;
            padding: 30px;
            background: var(--brand-jade);
            border-radius: 12px;
            text-align: center;
            color: var(--brand-white);
            font-size: 0.9em;
        }

        footer a {
            color: var(--brand-coral);
            text-decoration: none;
        }

        footer a:hover {
            color: var(--brand-purple);
        }

        @media (max-width: 768px) {
            .analysis-grid {
                grid-template-columns: 1fr;
            }
        }

    </style>
</head>
<body>
    <header>
        <h1>Nachhaltigkeitsanalyse</h1>
        <div class="subtitle">{{FIRMENNAME}}</div>
        <div class="meta">
            <span>ESG Maturity Agent v3</span>
            <span>Analysedatum: {{DATUM}}</span>
            <span>Quellen: {{ANZAHL_QUELLEN}}</span>
        </div>
    </header>

    <section class="executive-summary">
        <h2>Executive Summary</h2>
        <p>{{EXECUTIVE_SUMMARY}}</p>
    </section>

    <!-- Unternehmensprofil -->
    <section>
        <h2>Unternehmensprofil</h2>
        <table class="detail-table">
            <tbody>
                {{UNTERNEHMENSPROFIL_ROWS}}
            </tbody>
        </table>

        <h3>Nachhaltigkeitsstrategie</h3>
        {{NACHHALTIGKEITSSTRATEGIE}}
    </section>

    <!-- Nachhaltigkeitsprofil mit Radar-Diagramm -->
    <section class="radar-hero" style="margin-top: 50px;">
        <h2 style="font-size: 1.8em; margin-bottom: 20px;">Nachhaltigkeitsprofil nach Ainsbury-Grayson</h2>
        <p style="max-width: 800px; margin: 0 auto 30px auto; color: #555; line-height: 1.7;">
            Das Radar-Diagramm visualisiert das Nachhaltigkeitsprofil und zeigt Stärken sowie Entwicklungspotenziale auf einen Blick.
        </p>
        <div class="radar-hero-container">
            <canvas id="radarChart"></canvas>
        </div>
        <p style="margin-top: 20px; color: #666; font-size: 0.9em;">
            Bewertung nach dem 5-Stages-of-Maturity-Modell (1 = Denier, 5 = Champion)
        </p>
    </section>

    <section class="page-break">
        <h2>Detailbewertung nach Kategorien</h2>
        <table class="detail-table">
            <thead>
                <tr>
                    <th style="width: 5%;">Nr</th>
                    <th style="width: 20%;">Kategorie</th>
                    <th style="width: 8%;">Score</th>
                    <th style="width: 15%;">Stage</th>
                    <th style="width: 8%;">Konfidenz</th>
                    <th style="width: 44%;">Begründung</th>
                </tr>
            </thead>
            <tbody>
                {{DETAIL_ROWS}}
            </tbody>
        </table>

        <!-- Stärken und Entwicklungspotenziale -->
        <div class="analysis-grid" style="grid-template-columns: repeat(2, 1fr); margin-top: 30px;">
            <div class="analysis-card" style="border-color: var(--brand-olive);">
                <h4 style="color: var(--brand-olive);">Top 3 Stärken</h4>
                <ol class="strengths" style="list-style: decimal; padding-left: 20px;">
                    {{TOP_STAERKEN}}
                </ol>
            </div>
            <div class="analysis-card" style="border-color: var(--brand-coral);">
                <h4 style="color: var(--brand-coral);">Top 3 Entwicklungspotenziale</h4>
                <ol class="weaknesses" style="list-style: decimal; padding-left: 20px;">
                    {{TOP_ENTWICKLUNGSPOTENZIALE}}
                </ol>
            </div>
        </div>
    </section>

    <section class="benchmark-section">
        <h2>Branchenvergleich</h2>

        <div class="benchmark-subsection">
            <h4>Brancheneinordnung</h4>
            <p>{{BRANCHENEINORDNUNG}}</p>
        </div>

        <div class="benchmark-subsection">
            <h4>Vergleichsunternehmen</h4>
            <table class="benchmark-table">
                <thead>
                    <tr>
                        <th>Unternehmen</th>
                        <th>Region</th>
                        <th>Größe</th>
                        <th>Nachhaltigkeits-Highlights</th>
                    </tr>
                </thead>
                <tbody>
                    {{VERGLEICHSUNTERNEHMEN_ROWS}}
                </tbody>
            </table>
        </div>

        <div class="benchmark-subsection">
            <h4>Positionierung im Wettbewerb</h4>
            {{POSITIONIERUNG_WETTBEWERB}}
        </div>

        <div class="benchmark-subsection">
            <h4>Branchenspezifische Herausforderungen</h4>
            {{BRANCHENSPEZIFISCHE_HERAUSFORDERUNGEN}}
        </div>

        <div class="benchmark-subsection">
            <h4>Best Practices der Branche</h4>
            {{BEST_PRACTICES}}
        </div>
    </section>

    <section class="sources">
        <h2>Quellen</h2>
        <ol>
            {{QUELLEN_LISTE}}
        </ol>
    </section>

    <!-- Methodik-Erklärung -->
    <section style="background: var(--light); padding: 30px; border-radius: 8px; margin-top: 40px; font-size: 0.9em;">
        <h2 style="font-size: 1.4em;">Das Ainsbury-Grayson-Modell</h2>
        <p style="margin-bottom: 20px;">Das Modell von Richard Ainsbury und David Grayson (Cranfield University, 2014) beschreibt fünf Reifegradstufen der gesellschaftlichen Verantwortung. Die Bewertung erfolgt anhand von 11 Verankerungsbereichen, die systematisch analysiert werden:</p>

        <h3 style="margin-bottom: 15px;">Die fünf Reifegradstufen</h3>
        <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin-bottom: 30px;">
            <div style="background: var(--stage-1); color: white; padding: 12px; border-radius: 8px; text-align: center;">
                <div style="font-weight: 600; font-size: 1.1em;">1 – Denier</div>
                <div style="font-size: 0.85em; margin-top: 8px; opacity: 0.95;">Keine Verantwortung für soziale, ökologische oder wirtschaftliche Auswirkungen.</div>
            </div>
            <div style="background: var(--stage-2); color: white; padding: 12px; border-radius: 8px; text-align: center;">
                <div style="font-weight: 600; font-size: 1.1em;">2 – Complier</div>
                <div style="font-size: 0.85em; margin-top: 8px; opacity: 0.95;">Erfüllt gesetzliche Vorgaben und folgt branchenüblichen Praktiken.</div>
            </div>
            <div style="background: var(--stage-3); color: var(--primary); padding: 12px; border-radius: 8px; text-align: center;">
                <div style="font-weight: 600; font-size: 1.1em;">3 – Risk Mitigator</div>
                <div style="font-size: 0.85em; margin-top: 8px;">Identifiziert wesentliche Auswirkungen und reduziert negative Impacts zur Risikominimierung.</div>
            </div>
            <div style="background: var(--stage-4); color: white; padding: 12px; border-radius: 8px; text-align: center;">
                <div style="font-weight: 600; font-size: 1.1em;">4 – Opportunity Maximiser</div>
                <div style="font-size: 0.85em; margin-top: 8px; opacity: 0.95;">Sucht systematisch nach Geschäftschancen, die auch positive gesellschaftliche Wirkung haben.</div>
            </div>
            <div style="background: var(--stage-5); color: white; padding: 12px; border-radius: 8px; text-align: center;">
                <div style="font-weight: 600; font-size: 1.1em;">5 – Champion</div>
                <div style="font-size: 0.85em; margin-top: 8px; opacity: 0.95;">Verankert Nachhaltigkeit in der Wertschöpfungskette, kollaboriert und setzt sich für Veränderung ein.</div>
            </div>
        </div>

        <h3 style="margin-bottom: 15px;">Die 11 Verankerungsbereiche (Embedding Categories)</h3>
        <table class="detail-table" style="margin-bottom: 0;">
            <tbody>
                <tr><td style="width: 5%;"><strong>1</strong></td><td style="width: 35%;"><strong>Purpose, Vision, Values & Strategy</strong></td><td>Wie stark sind Nachhaltigkeitsziele in der Unternehmensvision, den Werten und der Gesamtstrategie verankert?</td></tr>
                <tr><td><strong>2</strong></td><td><strong>Tone from the Top: Leadership</strong></td><td>Wie sichtbar und aktiv engagiert sich die Geschäftsführung für Nachhaltigkeitsthemen?</td></tr>
                <tr><td><strong>3</strong></td><td><strong>Board Oversight and Governance</strong></td><td>Wie ist Nachhaltigkeit in der Unternehmensführung und Aufsichtsratsarbeit verankert?</td></tr>
                <tr><td><strong>4</strong></td><td><strong>Key Targets, Incentives and Measurement</strong></td><td>Gibt es messbare Ziele, Anreizsysteme und systematisches Monitoring für Nachhaltigkeitsleistungen?</td></tr>
                <tr><td><strong>5</strong></td><td><strong>Embedded in Strategic Business Units</strong></td><td>Wie tief ist Nachhaltigkeit in den einzelnen Geschäftsbereichen und Funktionen integriert?</td></tr>
                <tr><td><strong>6</strong></td><td><strong>Engaging Employees</strong></td><td>Wie werden Mitarbeitende eingebunden, informiert und für Nachhaltigkeit aktiviert?</td></tr>
                <tr><td><strong>7</strong></td><td><strong>Energising the Value Chain</strong></td><td>Wie werden Lieferanten, Kunden und Partner in die Nachhaltigkeitsaktivitäten einbezogen?</td></tr>
                <tr><td><strong>8</strong></td><td><strong>Skills, Knowledge Management and Training</strong></td><td>Wie werden Nachhaltigkeitskompetenzen aufgebaut, geteilt und weiterentwickelt?</td></tr>
                <tr><td><strong>9</strong></td><td><strong>Stakeholder Engagement, Communications</strong></td><td>Wie transparent und dialogorientiert kommuniziert das Unternehmen mit seinen Stakeholdern?</td></tr>
                <tr><td><strong>10</strong></td><td><strong>Collaborations, Partnerships and Networks</strong></td><td>Wie aktiv beteiligt sich das Unternehmen an Brancheninitiativen und Partnerschaften?</td></tr>
                <tr><td><strong>11</strong></td><td><strong>Specialist CR Function</strong></td><td>Wie ist die Nachhaltigkeitsfunktion organisatorisch aufgestellt und mit Ressourcen ausgestattet?</td></tr>
            </tbody>
        </table>
    </section>

    <footer>
        <p>Analyse basierend auf dem Ainsbury-Grayson 5-Stages-of-Maturity-Modell</p>
        <p>Doughty Centre for Corporate Responsibility, Cranfield University (2014)</p>
        <p><a href="https://36sustainability.org" target="_blank">36sustainability.org</a></p>
    </footer>

    <script>
        // Radar Chart Configuration
        const ctx = document.getElementById('radarChart').getContext('2d');

        // Kategorie-Labels (gekürzt für Lesbarkeit)
        const labels = [
            'Purpose & Strategy',
            'Leadership',
            'Board Governance',
            'Targets & Incentives',
            'Business Units',
            'Employees',
            'Value Chain',
            'Skills & Training',
            'Stakeholder Comm.',
            'Partnerships',
            'CR Function'
        ];

        // Bewertungsdaten - werden durch den Agent ersetzt
        const scores = [{{RADAR_SCORES}}]; // z.B. [3, 4, 3, 2, 3, 4, 3, 2, 4, 3, 3]

        // Dynamische Farbe basierend auf Scores
        function getScoreColor(scores) {
            const avg = scores.reduce((a, b) => a + b, 0) / scores.length;
            if (avg < 2) return 'rgba(231, 76, 60, 1)';
            if (avg < 3) return 'rgba(230, 126, 34, 1)';
            if (avg < 4) return 'rgba(241, 196, 15, 1)';
            return 'rgba(39, 174, 96, 1)';
        }

        const chartColor = getScoreColor(scores);

        new Chart(ctx, {
            type: 'radar',
            data: {
                labels: labels,
                datasets: [{
                    label: '{{FIRMENNAME}}',
                    data: scores,
                    fill: true,
                    backgroundColor: chartColor.replace(', 1)', ', 0.35)'),
                    borderColor: chartColor,
                    pointBackgroundColor: chartColor,
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: chartColor,
                    borderWidth: 3
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                scales: {
                    r: {
                        angleLines: {
                            display: true,
                            color: '#ddd'
                        },
                        suggestedMin: 0,
                        suggestedMax: 5,
                        ticks: {
                            stepSize: 1,
                            font: {
                                size: 12
                            },
                            backdropColor: 'transparent'
                        },
                        pointLabels: {
                            font: {
                                size: 13,
                                weight: '500'
                            }
                        },
                        grid: {
                            color: '#e0e0e0'
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: true,
                        position: 'bottom',
                        labels: {
                            font: {
                                size: 14
                            }
                        }
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const stageNames = ['', 'Denier', 'Complier', 'Risk Mitigator', 'Opportunity Maximiser', 'Champion'];
                                const score = context.raw;
                                return `Score: ${score} (${stageNames[Math.round(score)]})`;
                            }
                        }
                    }
                }
            }
        });
    </script>
</body>
</html>
